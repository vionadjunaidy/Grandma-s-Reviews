<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Upload Recipe</title>
    <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">
    <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>
    <style>
        small {
            background-color: yellow;
        }
    </style>
    <script>
        $(document).ready(function () {
            $("#namecheck").hide();
            let nameError = true;
            $("#name").keyup(function () {
                validateName();
            });
            function validateName() {
                let nameValue = $("#name").val();
                if (nameValue.length == "") {
                    $("#namecheck").show();
                    nameError = false;
                    return false;
                }
                else if (nameValue.length < 3) {
                    $("#namecheck").show();
                    $("#namecheck").html("Recipe name is at least 3 characters");
                    nameError = false;
                    return false;
                }
                else {
                    $("#namecheck").hide();
                }
            }

            $("#descriptioncheck").hide();
            let descriptionError = true;
            $("#description").keyup(function () {
                validateDescription();
            });
            function validateDescription() {
                let descriptionValue = $("#description").val();
                if (descriptionValue.length == "") {
                    $("#descriptioncheck").show();
                    descriptionError = false;
                    return false;
                }
                else if (descriptionValue.length < 30 || descriptionValue.length > 250) {
                    $("#descriptioncheck").show();
                    $("#descriptioncheck").html("Length of description must be between 30 and 250 characters!");
                    descriptinoError = false;
                    return false;
                }
                else {
                    $("#descriptioncheck").hide();
                }
            }

            $("#portioncheck").hide();
            let portionError = true;
            $("#portion").keyup(function () {
                validatePortion();
            });
            function validatePortion() {
                let portionValue = $("#portion").val();
                if (portionValue.length == "") {
                    $("#portioncheck").show();
                    portionError = false;
                    return false;
                }
                else {
                    $("#portioncheck").hide();
                }
            }

            $("#durationPicker").on("input", function () {
                validateDuration();
            });

            $("#durationcheck").hide();
            let durationError = true;
            function validateDuration() {
                var durationValue = $("#durationPicker").val().toLowerCase();

                var regex = /^(\d+)\s*(hours?|mins?)\s*((\d+)\s*mins?)?$/;
                if (durationValue.length == "") {
                    $("#durationcheck").show();
                    durationError = false;
                    return false;
                }
                else if (regex.test(durationValue)) {
                    console.log("Valid duration:", durationValue);
                    $("#durationcheck").hide()
                } else {
                    console.log("Invalid duration:", durationValue);
                    $("#durationcheck").show()
                    $("#durationcheck").html("Invalid duration!")
                }
            }

            $("#durationPicker2").on("input", function () {
                validateDuration2();
            });
            $("#durationcheck2").hide();
            let duration2Error = true;
            function validateDuration2() {
                var duration2Value = $("#durationPicker2").val().toLowerCase();

                var regex = /^(\d+)\s*(hours?|mins?)\s*((\d+)\s*mins?)?$/;
                if (duration2Value.length == "") {
                    $("#durationcheck2").show();
                    duration2Error = false;
                    return false;
                }
                else if (regex.test(duration2Value)) {
                    console.log("Valid duration:", duration2Value);
                    $("#durationcheck2").hide()
                } else {
                    console.log("Invalid duration:", duration2Value);
                    $("#durationcheck2").show()
                    $("#durationcheck2").html("Invalid duration!")
                }
            }

            $(function () {
                function addListItem($input, $list, e) {
                    if (e.type === "keydown" && e.which !== 13) return;

                    e.preventDefault();

                    var newItemText = $input.val().trim();

                    if (newItemText !== "") {
                        $list.append("<li>" + newItemText + "</li>");
                        $input.val("");
                    }
                }

                var $input1 = $("#listIngredient"),
                    $list1 = $("#list1"),
                    $input2 = $("#listStep"),
                    $list2 = $("#list2");

                $("#btn1").click(function (e) {
                    addListItem($input1, $list1, e);
                });

                $("#listIngredient").keydown(function (e) {
                    addListItem($input1, $list1, e);
                });

                $("#btn2").click(function (e) {
                    addListItem($input2, $list2, e);
                });

                $("#listStep").keydown(function (e) {
                    addListItem($input2, $list2, e);
                });
            });

            $("#list1check").hide();
            let ingredientError = true;
            $("#list1").on("input", function () {
                validateIngredient();
            })
            function validateIngredient() {
                let ingredientValue = $("#list1").find("li");
                if (ingredientValue.length === 0) {
                    $("#list1check").show();
                    ingredientError = false;
                    return false;
                }
                else {
                    $("#list1check").hide();
                }
            }

            $("#list2check").hide();
            let stepError = true;
            $("#list2").on("input", function () {
                validateStep();
            })
            function validateStep() {
                let stepValue = $("#list2").find("li");
                if (stepValue.length === 0) {
                    $("#list2check").show();
                    stepError = false;
                    return false;
                }
                else {
                    $("#list2check").hide();
                }
            }

            $('#photocheck').hide();
            let photoError = true;
            $("#img").change(function () {
                validatePhoto();
            })
            function validatePhoto() {
                let photoValue = $("#img").val();
                if (photoValue == "") {
                    $("#photocheck").show();
                    photoError = false;
                    return false;
                }
                else {
                    $("#photocheck").hide();
                }
            }

            $('#categorycheck').hide();
            let categoryError = true;
            $("#category").change(function () {
                validateCategory();
            })
            function validateCategory() {
                let categoryValue = $("#category").val();
                if (categoryValue == "initial") {
                    $("#categorycheck").show();
                    categoryError = false;
                    return false;
                }
                else {
                    $("#categorycheck").hide();
                }
            }

            $("#submitbtn").click(function (event) {
                validateName();
                validateDescription();
                validatePortion();
                validatePhoto();
                validateCategory();
                validateIngredient();
                validateStep();
                validateDuration();
                validateDuration2();
                if (
                    nameError == true &&
                    descriptionError == true &&
                    portionError == true &&
                    ingredientError == true &&
                    stepError == true &&
                    durationError == true &&
                    duration2Error == true &&
                    photoError == true &&
                    categoryError == true
                ) {
                    return true;
                } else {
                    return false;
                }
            });
        });
    </script>
</head>

<body style="background-color: #C7AB59;">
    <a href="recipe(1).html"><button class="w3-button w3-blue w3-round w3-ripple">Back</button></a>
    <div style="display: flex;flex-wrap: wrap;justify-content: center;">
        <div class="w3-container w3-padding" style="max-width: 800px;">
            <form action="/action_page.php" id="submitform"
                class="needs-validation w3-container w3-card-4 w3-margin w3-round"
                style="background-color: #302718;color: white;" novalidate>
                <h2 class="w3-center">Upload Recipe</h2>
                <div class="w3-row w3-section w3-rest">
                    <input id="name" class="form-control w3-input w3-border w3-round" type="text" name="name"
                        placeholder="Recipe Name*" required>
                    <small id="namecheck" class="form-text text-muted invalid-feedback">Recipe name is missing</small>
                </div>
                <div class="w3-row w3-section w3-rest">
                    <textarea id="description" class="form-control w3-round" name="description"
                        placeholder="Description*" required></textarea>
                    <small id="descriptioncheck" class="form-text text-muted invalid-feedback">Description is
                        missing</small>
                </div>
                <div class="w3-row w3-section w3-rest">
                    <input type="number" class="form-control w3-input w3-border w3-round" id="portion" name="portion"
                        placeholder="Portion*">
                    <small id="portioncheck" class="form-text text-muted invalid-feedback">Portion is missing</small>
                </div>
                <div class="w3-section w3-rest">
                    <input type="text" id="durationPicker" class="form-control w3-input w3-border w3-round"
                        placeholder="Preparation time (e.g., 10 mins or 1 hour)" required>
                    <small id="durationcheck" class="form-text text-muted invalid-feedback">Prep time is missing</small>
                </div>
                <div class="w3-section w3-rest">
                    <input type="text" id="durationPicker2" class="form-control w3-input w3-border w3-round"
                        placeholder="Cooking time (e.g., 10 mins or 1 hour)" required>
                    <small id="durationcheck2" class="form-text text-muted invalid-feedback">Cook time is
                        missing</small>
                </div>
                <!--https://stackoverflow.com/questions/41919385/how-to-add-new-items-in-jquery-to-do-list-when-enter-is-pressed-->
                <hr style="border-color: white;border-width: 2px;">
                <div class="w3-section w3-rest">
                    <input type="text" class="form-control w3-input w3-border w3-round" id="listIngredient"
                        name="listIngredient" placeholder="Input ingredients*:" required>
                    <small id="list1check" class="form-text text-muted invalid-feedback">Ingredient is missing</small>
                    <ol id="list1"></ol>
                    <button id="btn1" class="w3-button w3-green w3-round w3-block w3-section w3-ripple w3-padding">Add
                        ingredient</button>
                </div>
                <hr style="border-color: white;border-width: 2px;">
                <div class="w3-section w3-rest">
                    <input type="text" class="form-control w3-input w3-border w3-round" id="listStep" name="listStep"
                        placeholder="Input steps*:" required>
                    <small id="list2check" class="form-text text-muted invalid-feedback">Step is missing</small>
                    <ol id="list2"></ol>
                    <button id="btn2" class="w3-button w3-green w3-round w3-block w3-section w3-ripple w3-padding">Add
                        step</button>
                </div>
                <hr style="border-color: white;border-width: 2px;">
                <div class="w3-section w3-rest">
                    <label for="img">Select pictures of the food/recipe</label>
                    <input type="file" id="img" name="img" accept="image/*" multiple>
                    <small id="photocheck" class="form-text text-muted invalid-feedback">Photo is missing</small>
                </div>
                <div class="w3-section w3-rest">
                    <label for="category">Choose a category:</label>
                    <select id="category" name="category" class="form-control w3-input w3-border w3-round" required>
                        <option value="initial" hidden>Category</option>
                        <option value="local">Local Indonesian</option>
                        <option value="asian">Asian</option>
                        <option value="western">Western</option>
                    </select>
                    <small id="categorycheck" class="form-text text-muted invalid-feedback">Category is missing</small>
                </div>
                
                <div><a href="recipe(1).html"><input id="submitbtn" type="button" name="submitbtn" value="Submit"
                        class="w3-button w3-blue w3-round w3-block w3-section w3-ripple w3-padding"></a></div>
            </form>
        </div>
    </div>
</body>

</html>